<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using Coereba • Coereba</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="Workflow_files/libs/quarto-html/popper.min.js"></script><script src="Workflow_files/libs/quarto-html/tippy.umd.min.js"></script><link href="Workflow_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Workflow_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using Coereba">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Coereba</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Workflow.html">Using Coereba</a></li>
    <li><a class="dropdown-item" href="../articles/Workflow2.html">Workflow2</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DavidRach/Coereba/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using Coereba</h1>

      <p class="author">David Rach</p>
      <p class="date">2025-12-02</p>

      <small class="dont-index">Source: <a href="https://github.com/DavidRach/Coereba/blob/HEAD/vignettes/Workflow.qmd" class="external-link"><code>vignettes/Workflow.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  eval <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<section class="level2"><h3 id="installing-coereba">Installing Coereba<a class="anchor" aria-label="anchor" href="#installing-coereba"></a>
</h3>
<p>We are in the process of preparing Coereba to submit to Bioconductor later this year. Until then, the developmental version can be installed via GitHub.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/DavidRach/Coereba"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># install.packages("BiocManager")</span></span>
<span><span class="co"># BiocManager::install("Coereba")</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="load-required-libraries">Load Required Libraries<a class="anchor" aria-label="anchor" href="#load-required-libraries"></a>
</h3>
<p>Coereba primarily relies on the infrastructure provided <em><a href="https://bioconductor.org/packages/3.21/flowWorkspace" class="external-link">flowWorkspace</a></em> and other Bioconductor cytometry R packages. It additionally leverages various <em><a href="https://CRAN.R-project.org/package=tidyverse" class="external-link">tidyverse</a></em> packages available via CRAN. Before starting, it is important to make sure all required packages are first installed, and that library is called for each to make them available.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CRAN packages: install.packages("ThePackageName")</span></span>
<span></span>
<span><span class="co"># library(dplyr)</span></span>
<span><span class="co"># library(purrr) </span></span>
<span><span class="co"># library(stringr)</span></span>
<span><span class="co"># library(ggplot2)</span></span>
<span><span class="co"># library(gt)</span></span>
<span><span class="co"># library(plotly)</span></span>
<span><span class="co"># library(htmltools)</span></span>
<span><span class="co"># library(data.table)</span></span>
<span></span>
<span><span class="co"># Bioconductor packages: BiocManager::install("ThePackageName")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavidRach/Coereba" class="external-link">Coereba</a></span><span class="op">)</span></span>
<span><span class="co">#library(flowCore)</span></span>
<span><span class="co">#library(flowWorkspace)</span></span>
<span><span class="co">#library(openCyto)</span></span>
<span><span class="co">#library(ggcyto)  </span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="locate-your-files">Locate your files<a class="anchor" aria-label="anchor" href="#locate-your-files"></a>
</h3>
<p>You will next need to provide to your computer the location where your .fcs files of interest are stored. An example of how the author does this for the various computer operating systems is shown below. Please modify the file.paths accordingly to match your own username and folder location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For Windows Operating Systems</span></span>
<span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span>, <span class="st">"TodaysExperiment"</span><span class="op">)</span></span>
<span><span class="va">FCS_Pattern</span> <span class="op">&lt;-</span> <span class="st">".fcs$"</span></span>
<span><span class="va">FCS_Files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">File_Location</span>, pattern <span class="op">=</span> <span class="va">FCS_Pattern</span>,</span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For Mac</span></span>
<span></span>
<span><span class="co"># For Linux</span></span>
<span><span class="co"># File_Location &lt;- file.path("/home", "JohnDoe", "Desktop", "TodaysExperiment")</span></span></code></pre></div>
</div>
<p>For this vignette, we will be utilizing several .fcs files that are stored within Coereba’s extdata folder. These consist of unmixed .fcs files from a 32 fluorophore Spectral Flow Cytometry panel. We manually gated down to CD4-CD8- (DN) T cells, from which we downsampled up to 1000 cells to create a sufficiently small dataset to use for the R package documentation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span><span class="va">FCS_Pattern</span> <span class="op">&lt;-</span> <span class="st">".fcs$"</span></span>
<span><span class="va">FCS_Files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">File_Location</span>, pattern <span class="op">=</span> <span class="va">FCS_Pattern</span>,</span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">FCS_Files</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/2025_07_26_AB_02_INF052_00_SEB.fcs"
[2] "C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/2025_07_26_AB_02_INF100_00_SEB.fcs"
[3] "C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/2025_07_26_AB_02_INF179_00_SEB.fcs"</code></pre>
</div>
</div>
</section><section class="level2"><h3 id="creating-a-gatingset">Creating a GatingSet<a class="anchor" aria-label="anchor" href="#creating-a-gatingset"></a>
</h3>
<section class="level3"><h4 id="flowworkspace-and-opencyto">flowWorkspace and openCyto<a class="anchor" aria-label="anchor" href="#flowworkspace-and-opencyto"></a>
</h4>
<p>Working with the unmixed .fcs files we have identified above, we will group them into a GatingSet object where we can further interact with them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UnmixedFCSFiles</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span></span>
<span><span class="va">UnmixedCytoSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/load_cytoset_from_fcs.html" class="external-link">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">UnmixedFCSFiles</span>, truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                        transformation <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A GatingSet with 30 samples</code></pre>
</div>
</div>
<p>Now that we have created a GatingSet object, we will generate list of the fluorophores and markers present. We will then exclude from this list markers that don’t require transformation (FSC, SSC, etc.) For this example, we will biexponentially transform our data using the <em><a href="https://bioconductor.org/packages/3.21/flowWorkspace" class="external-link">flowWorkspace</a></em> <code><a href="https://rdrr.io/pkg/flowWorkspace/man/flowjo_biexp_trans.html" class="external-link">flowWorkspace::flowjo_biexp_trans()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">MyBiexponentialTransform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/flowjo_biexp_trans.html" class="external-link">flowjo_biexp_trans</a></span><span class="op">(</span>channelRange <span class="op">=</span> <span class="fl">256</span>, maxValue <span class="op">=</span> <span class="fl">1000000</span>,</span>
<span>                                               pos <span class="op">=</span> <span class="fl">4.5</span>, neg <span class="op">=</span> <span class="fl">0</span>, widthBasis <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">TransformList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/transformerList.html" class="external-link">transformerList</a></span><span class="op">(</span><span class="va">KeptMarkers</span>, <span class="va">MyBiexponentialTransform</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span>, <span class="va">TransformList</span><span class="op">)</span></span></code></pre></div>
</div>
<p>For this example, we will apply a <em><a href="https://bioconductor.org/packages/3.21/openCyto" class="external-link">openCyto</a></em>gating template that can be found in the extdata folder to apply a gate to distinguish Vdelta2 cells from other DN T cells.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UnmixedGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">File_Location</span>, pattern <span class="op">=</span> <span class="st">'GatesUnmixed.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">UnmixedGating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gatingTemplate-class.html" class="external-link">gatingTemplate</a></span><span class="op">(</span><span class="va">UnmixedGates</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding population:Vd2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gt_gating.html" class="external-link">gt_gating</a></span><span class="op">(</span><span class="va">UnmixedGating</span>, <span class="va">UnmixedGatingSet</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Gating for 'Vd2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>done!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code><span><span class="va">done.</span></span></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code><span><span class="va">finished.</span></span></code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can additionally verify that the gating of the cell populations of interest was correct, by visualizing the gates using <em><a href="https://bioconductor.org/packages/3.21/ggcyto" class="external-link">ggcyto</a></em> or the <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_GatingPlots.html" class="external-link">Luciernaga::Utility_GatingPlots</a></code> function from the <code>Luciernaga</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidrach.github.io/Luciernaga/" class="external-link">Luciernaga</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">MyPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_GatingPlots.html" class="external-link">Utility_GatingPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span>, <span class="st">"TUBENAME"</span><span class="op">)</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="st">".fcs"</span>, subset<span class="op">=</span><span class="st">"root"</span>, gtFile<span class="op">=</span><span class="va">UnmixedGates</span>,</span>
<span>                              DesiredGates<span class="op">=</span><span class="cn">NULL</span>, returnType<span class="op">=</span><span class="st">"plots"</span>, outpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                              therows<span class="op">=</span><span class="fl">1</span>, thecolumns<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MyPlot</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/Checking%20the%20openCyto%20gate-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="cytoml">CytoML<a class="anchor" aria-label="anchor" href="#cytoml"></a>
</h4>
<p>An alternative approach to creating a new GatingSet with <em><a href="https://bioconductor.org/packages/3.21/openCyto" class="external-link">openCyto</a></em>, would to be to import an existing FlowJo workspace using <em><a href="https://bioconductor.org/packages/3.21/CytoML" class="external-link">CytoML</a></em>. The workflow for this approach would look something as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For Windows Operating Systems</span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span>, <span class="st">"TodaysExperiment"</span><span class="op">)</span></span>
<span><span class="va">wsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">".wsp"</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/CytoML" class="external-link">CytoML</a></span><span class="op">)</span></span>
<span><span class="va">ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CytoML/man/open_flowjo_xml.html" class="external-link">open_flowjo_xml</a></span><span class="op">(</span><span class="va">wsp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">CytoML_GS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CytoML/man/flowjo_to_gatingset.html" class="external-link">flowjo_to_gatingset</a></span><span class="op">(</span><span class="va">ws</span>, name<span class="op">=</span><span class="fl">1</span>, path <span class="op">=</span> <span class="va">folder</span>, additional.keys<span class="op">=</span><span class="st">"GROUPNAME"</span><span class="op">)</span></span>
<span><span class="va">CytoML_GS</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A GatingSet with 30 samples</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidrach.github.io/Luciernaga/" class="external-link">Luciernaga</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">MyPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_GatingPlots.html" class="external-link">Utility_GatingPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">CytoML_GS</span><span class="op">[</span><span class="fl">27</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span>, <span class="st">"TUBENAME"</span><span class="op">)</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="st">".fcs"</span>, subset<span class="op">=</span><span class="st">"root"</span>, gtFile<span class="op">=</span><span class="va">UnmixedGates</span>,</span>
<span>                              DesiredGates<span class="op">=</span><span class="cn">NULL</span>, returnType<span class="op">=</span><span class="st">"plots"</span>, outpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                              therows<span class="op">=</span><span class="fl">1</span>, thecolumns<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MyPlot</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/Checking%20CytoML%20output-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section class="section level2"><h2 id="coereba">Coereba<a class="anchor" aria-label="anchor" href="#coereba"></a>
</h2>
<p>Having set up a GatingSet and applied the transformations and gates, we can now proceed to the main <code>Coereba</code> workflow.</p>
<p>For this example, we will focus on just 4 of the 32 markers, CD16 (BV570), CXCR5 (RB780), HLA-DR(PE-Vio770), and Vdelta2 (BUV661). Most cord DN T cells are negative for these markers, but 5-25% are positive, so they are good examples to showcase the gate adjustment mechanisms. The process when working with all 32-markers is similar, but will take a little more compute time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># BV570=CD16, RB780=CXCR5, BUV661=Vd2, PE-Vio770=HLA-DR</span></span>
<span></span>
<span><span class="va">MarkersForToday</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Comp-BV570-A"</span>, <span class="st">"Comp-RB780-A"</span>, <span class="st">"Comp-BUV661-A"</span>, <span class="st">"Comp-PE-Vio770-A"</span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level2"><h3 id="return-a-coereba-gate-cutoff-template">Return a Coereba Gate cutoff template<a class="anchor" aria-label="anchor" href="#return-a-coereba-gate-cutoff-template"></a>
</h3>
<p>The first step is to create a .csv file, containing the individual specimens, and the individual markers of interest. Each cell within the .csv file will correspond to the MFI for a given marker for a given individual where positive expression of a marker transitions to becoming a negative (referred here to as a splitpoint).</p>
<p>These could be specified out individually, or derrived in an automated fashion. In Coereba, we leverage the <em><a href="https://bioconductor.org/packages/3.21/openCyto" class="external-link">openCyto</a></em> automated gating functions (primarily the gate_mindensity option) to save us from the eye-strain of typing everything out. We will run the <code><a href="../reference/Coereba_GateCutoffs.html">Coereba_GateCutoffs()</a></code> function on each specimen in the GatingSet, and use the <em><a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a></em> packages <code>bind_rows()</code>to gather the rows into a data.frame object. We in turn can save this as a .csv for later use (or minor hand editing).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Designate a location file.path to save the calculated splitpoints .csv to. </span></span>
<span><span class="va">StorageLocationForSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheGateCutoffs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">UnmixedGatingSet</span>, .f<span class="op">=</span><span class="va">Coereba_GateCutoffs</span>,</span>
<span>  subset<span class="op">=</span><span class="st">"root"</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span><span class="op">)</span>, desiredCols<span class="op">=</span><span class="va">MarkersForToday</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheFileName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">StorageLocationForSplitpoints</span>, <span class="st">"InitialGates.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">TheGateCutoffs</span>, <span class="va">TheFileName</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheGateCutoffs</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen Comp-BV570-A Comp-RB780-A Comp-BUV661-A Comp-PE-Vio770-A
1    INF052     95.99572     79.81768      92.62814         129.9561
2    INF100    103.33433     94.25437     114.69530         116.6564
3    INF179    109.89267    128.23631     110.01708         150.9991
4  NY068_02    114.44753     96.39710     132.30234         164.5997
5    INF134    124.42033     91.52706      93.54602         151.1548
6    INF148     95.80705     98.21272      92.21258         156.4832
7    INF191     97.24318     95.13298      90.39015         150.5763
8  NY068_03    119.66857     94.20034     133.03712         166.7616
9    INF124    103.73583     97.52455      92.24351         135.2992
10   INF149    102.38780     90.80628      91.17560         134.0682
11   INF169     98.05572     96.86912      91.20649         143.2990
12 NY068_04    101.86016    148.96872     134.22594         163.1704
13   INF019    118.66055    119.15168     111.03801         150.8361
14   INF032    100.12555    128.39530      90.89821         155.1842
15   INF180    109.81433    134.41540     123.40675         151.3544
16 NY068_05    129.94157    124.96124     134.95695         180.8834
17   INF155    127.16077     92.08128      90.55976         135.4164
18   INF158    103.49512    123.41416     100.13277         151.0280
19   INF159    102.40065     93.02662     115.63440         151.8577
20 NY068_06    134.49746     95.33254     132.96382         165.9432
21   INF023    127.91245    109.67568     108.11141         133.5714
22   INF030    125.73654    138.79580      92.29818         171.0362
23 NY068_07    119.26432    116.28047     134.65951         165.2359
24   INF166    100.86925    128.41642      91.56946         145.7076
25   INF199     96.16446     91.66441      90.65000         174.1244
26   INF207    130.57312     78.51149      93.95175         140.9981
27 NY068_08    111.68304    112.19372     135.69086         175.6439
28   INF614     92.62075    103.21807      91.92536         150.7596
29   INF622    104.76776    105.21465     133.13021         134.9934
30 NY068_09    126.99610    100.68112     134.55885         168.3020</code></pre>
</div>
</div>
<p>With these intial split points calculated, we can visualize how well the splitpoints were calculated by plotting them as red-lines using the <code>Luciernaga</code> packages <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_NbyNPlots.html" class="external-link">Utility_NbyNPlots()</a></code> (visualizing all marker combinations for an individual specimen) and <code>Utility_UnityPlots()</code> (visualizing a marker combination across all specimens) functions. The resulting plots can be returned to R using either the returntype= “plots” or “patchwork” arguments, or saved to the directory by providing the “pdf” argument instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Designate a location</span></span>
<span><span class="va">StorageLocationForPlotPDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForPlotPDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_NbyNPlots.html" class="external-link">Utility_NbyNPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span><span class="op">)</span>, experiment<span class="op">=</span><span class="st">"ABs"</span>,</span>
<span>condition<span class="op">=</span><span class="st">"DNs"</span>, removestrings<span class="op">=</span><span class="st">".fcs"</span>, marginsubset<span class="op">=</span><span class="st">"root"</span>, gatesubset<span class="op">=</span><span class="st">"root"</span>, </span>
<span>ycolumn<span class="op">=</span><span class="st">"Comp-PE-Vio770-A"</span>, bins<span class="op">=</span><span class="fl">150</span>, clearance<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>gatelines<span class="op">=</span><span class="cn">TRUE</span>, reference<span class="op">=</span><span class="va">TheGateCutoffs</span>, outpath<span class="op">=</span><span class="va">StorageLocationForPlotPDF</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>When a marker has distinct positive or negative markers, the initial estimated location works well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Plot</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>However, when everything is uniformly positive or negative, or more subtle shift, these estimated locations can be quite off, and the respective splitpoints will need to be corrected. If a particular marker(s) is consistently off, we can redo the splitpoints for individual markers by providing gate_range arguments to constrain the mindensity to searching within a particular area.</p>
<p>The simplest way to do this is to set the <code><a href="../reference/Coereba_GateCutoffs.html">Coereba_GateCutoffs()</a></code> returnTemplate argument to TRUE, which will return a TemplateForGates.csv based off the openCyto template .csv.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Designate a location file.path to save the template to. </span></span>
<span><span class="va">StorageLocationForTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ReturnATemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_GateCutoffs.html">Coereba_GateCutoffs</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  subset<span class="op">=</span><span class="st">"root"</span>, sample.name<span class="op">=</span><span class="st">"GROUPNAME"</span>, desiredCols<span class="op">=</span><span class="va">MarkersForToday</span>, </span>
<span>  returnTemplate<span class="op">=</span><span class="cn">TRUE</span>, outpath<span class="op">=</span><span class="va">StorageLocationForTemplate</span><span class="op">)</span>   </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">StorageLocationForTemplate</span>,</span>
<span> pattern<span class="op">=</span><span class="st">"TemplateForGates.csv"</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheTemplateCSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">TheTemplate</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             alias pop parent             dims   gating_method gating_args
1     Comp-BV570-A   -   root     Comp-BV570-A gate_mindensity          NA
2     Comp-RB780-A   -   root     Comp-RB780-A gate_mindensity          NA
3    Comp-BUV661-A   -   root    Comp-BUV661-A gate_mindensity          NA
4 Comp-PE-Vio770-A   -   root Comp-PE-Vio770-A gate_mindensity          NA
  collapseDataForGating groupBy preprocessing_method preprocessing_args
1                 FALSE      NA                   NA                 NA
2                 FALSE      NA                   NA                 NA
3                 FALSE      NA                   NA                 NA
4                 FALSE      NA                   NA                 NA</code></pre>
</div>
</div>
<p>We can then manually update with the gate_range arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#On your own workstation</span></span>
<span></span>
<span><span class="va">UpdatedTemplatePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span>,</span>
<span><span class="st">"UpdatedTemplateForGates.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For our documentation's example</span></span>
<span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UpdatedTemplatePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">folder</span>, pattern<span class="op">=</span><span class="st">"UpdatedTemplateForGates.csv"</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UpdatedTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">UpdatedTemplatePath</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UpdatedTemplate</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             alias pop parent             dims   gating_method
1     Comp-BV570-A   -   root     Comp-BV570-A gate_mindensity
2     Comp-RB780-A   -   root     Comp-RB780-A gate_mindensity
3    Comp-BUV661-A   -   root    Comp-BUV661-A gate_mindensity
4 Comp-PE-Vio770-A   -   root Comp-PE-Vio770-A gate_mindensity
            gating_args collapseDataForGating groupBy preprocessing_method
1 gate_range=c(100,115)                 FALSE      NA                   NA
2 gate_range=c(100,115)                 FALSE      NA                   NA
3 gate_range=c(100,115)                 FALSE      NA                   NA
4 gate_range=c(120,135)                 FALSE      NA                   NA
  preprocessing_args
1                 NA
2                 NA
3                 NA
4                 NA</code></pre>
</div>
</div>
<p>With this done, we can provide it back to <code><a href="../reference/Coereba_GateCutoffs.html">Coereba_GateCutoffs()</a></code> with the GateOverwrite argument set to TRUE. This will restart the calculation of the splitpoints.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheUpdatedGateCutoffs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">UnmixedGatingSet</span>, .f<span class="op">=</span><span class="va">Coereba_GateCutoffs</span>,</span>
<span>  subset<span class="op">=</span><span class="st">"root"</span>, sample.name<span class="op">=</span><span class="st">"GROUPNAME"</span>, desiredCols<span class="op">=</span><span class="va">MarkersForToday</span>,</span>
<span>  GatingTemplate<span class="op">=</span><span class="va">UpdatedTemplatePath</span>, GateOverwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Designate a location file.path to save the template to. </span></span>
<span><span class="va">StorageLocationForUpdatedSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForUpdatedSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SecondGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">StorageLocationForUpdatedSplitpoints</span>, <span class="st">"SecondGates.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">TheUpdatedGateCutoffs</span>, <span class="va">SecondGates</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheUpdatedGateCutoffs</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen Comp-BV570-A Comp-RB780-A Comp-BUV661-A Comp-PE-Vio770-A
1    INF052     106.4243     113.5925      113.6929         129.9561
2    INF100     103.3343     106.1959      114.6953         125.4605
3    INF179     109.8927     100.0000      110.0171         120.0000
4  NY068_02     114.4475     112.1331      100.0000         133.7100
5    INF134     100.0000     113.8992      101.3027         125.8119
6    INF148     109.9491     112.7546      110.7753         120.0000
7    INF191     112.2095     111.5551      104.6742         121.1411
8  NY068_03     104.7751     105.4302      100.0000         120.0000
9    INF124     103.7358     103.3443      102.5415         120.0000
10   INF149     102.3878     113.7956      102.5606         134.0682
11   INF169     111.7433     114.8728      109.4655         120.0000
12 NY068_04     101.8602     114.4828      100.0000         120.0000
13   INF019     100.0000     110.0912      111.0380         124.7991
14   INF032     100.1255     113.5904      100.3742         120.0000
15   INF180     109.8143     100.0000      113.1625         120.0000
16 NY068_05     113.1065     107.7955      100.0000         129.2545
17   INF155     110.6196     104.2215      108.2798         132.0553
18   INF158     103.4951     105.1166      100.1328         125.5335
19   INF159     102.4007     109.3739      106.1045         120.0000
20 NY068_06     102.9558     103.3860      100.0000         120.0000
21   INF023     100.0000     109.6757      108.1114         133.5714
22   INF030     100.0000     112.3273      108.5369         129.9226
23 NY068_07     100.0000     103.3227      100.0000         120.0000
24   INF166     100.8692     100.0000      108.1121         120.0000
25   INF199     108.9003     101.8914      111.4071         128.5388
26   INF207     100.0000     108.6026      100.8434         125.9516
27 NY068_08     111.6830     112.1937      100.0000         120.0000
28   INF614     108.5193     103.2181      100.6354         125.9203
29   INF622     104.7678     105.2147      103.3615         134.9934
30 NY068_09     100.0000     100.6811      100.0000         120.0000</code></pre>
</div>
</div>
<p>This ultimately allows the splitpoint gate estimates to be closer to the true positive/negative split, resulting in less total adjustments that need to be done via the Coereba Shiny app.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StorageLocationForPlotPDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UpdatedPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_NbyNPlots.html" class="external-link">Utility_NbyNPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span><span class="op">)</span>, experiment<span class="op">=</span><span class="st">"ABs"</span>,</span>
<span>condition<span class="op">=</span><span class="st">"DNs"</span>, removestrings<span class="op">=</span><span class="st">".fcs"</span>, marginsubset<span class="op">=</span><span class="st">"root"</span>, gatesubset<span class="op">=</span><span class="st">"root"</span>, </span>
<span>ycolumn<span class="op">=</span><span class="st">"Comp-PE-Vio770-A"</span>, bins<span class="op">=</span><span class="fl">150</span>, clearance<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>gatelines<span class="op">=</span><span class="cn">TRUE</span>, reference<span class="op">=</span><span class="va">TheUpdatedGateCutoffs</span>, outpath<span class="op">=</span><span class="va">StorageLocationForPlotPDF</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UpdatedPlot</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="coereba_app">Coereba_App<a class="anchor" aria-label="anchor" href="#coereba_app"></a>
</h3>
<p>With the estimated splitpoints having been calculated, we still need to make sure to correct the location for the odd specimen that is of. We have created a R Shiny App to facilitate this process. When provided with the .csv of splitpoints, it will load in the GatingSet object, and plot an interactive version of <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_UnityPlot.html" class="external-link">Utility_UnityPlot()</a></code> from the <code>Luciernaga</code> package, visualizing the splitpoint for a given marker across all individuals as red vertical lines. These can then be updated via the graphical user interface (GUI) by clicking just above the axis.</p>
<p>First off, remember the location you saved the splitpoints .csv, as the Shiny App will ask you to find it later:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wherever you stored it</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For our example documentation</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span><span class="va">TheCSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">File_Location</span>, <span class="st">"SecondGates.csv"</span><span class="op">)</span></span>
<span><span class="va">TheCSVData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">TheCSV</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">TheCSVData</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen Comp-BV570-A Comp-RB780-A Comp-BUV661-A Comp-PE-Vio770-A
1   INF052     106.4243     113.5925      113.6929         129.9561
2   INF100     103.3343     106.1959      114.6953         125.4605
3   INF179     109.8927     100.0000      110.0171         120.0000
4 NY068_02     114.4475     112.1331      100.0000         133.7100
5   INF134     100.0000     113.8992      101.3027         125.8119
6   INF148     109.9491     112.7546      110.7753         120.0000</code></pre>
</div>
</div>
<p>Similarly, make sure to remember what you called your GatingSet (“UnmixedGatingSet” for our example), and the sample.name keyword used to identify individual specimens, as you will need to also provide these values to the app.</p>
<p>We will now launch the Shiny App by calling the <code><a href="../reference/Coereba_App.html">Coereba_App()</a></code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(DT)</span></span>
<span><span class="co">#library(plotly)</span></span>
<span><span class="co">#library(shiny)</span></span>
<span><span class="co">#library(shinydashboard)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Coereba_App.html">Coereba_App</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Upon launch, you land inside the Upload CSV File tab (located on the upper left). Go ahead and click on the Import .csv button.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ShinyLanding.png" style="width:75.0%"></p>
<p>Proceed to find and upload your SecondGates.csv equivalent (containing the updated splitpoints based on the gate_range constraints) by navigating to the storage folder location and select it. Once done, the contents will appear in the space on the right.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ShinySplitpointsLoaded.png" style="width:75.0%"></p>
<p>Next, you will select the “Upload a Gating Set” tab on the upper left.</p>
<p>What we now see is a way to provide arguments to the interactive version of <code>Utility_UnityPlots()</code></p>
<p>Enter the information about your GatingSet (“UnmixedGatingSet” for this example), select your desired x and y parameters (“Comp-BUV661-A”, etc), and the Sample.Name keyword that designates the respective specimens. The bins argument will adjust how th cells are visualized, with higher numbers being finer detail. Clearance is a proportion used to create additional space around the edge of the plot, which is set based on the values for the respective subset provided by the margin argument. The cells being plotted come from the “gate” subset box. Finally, click Display Estimated Gate Cutoffs to visualize the splitpoints as vertical red lines.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ShinyDetailsLoaded.png" style="width:75.0%"></p>
<p>Once this is done, click Generate Plots. If you view the console of the main R session, you will see the Utility_NbyNplot messages running as the plots are generated. How long it will take to load in the plots depends on the number of specimens, and the size of the files. Once the plots are loaded, wait a couple of seconds until you can hover with your mouse over the plots before clicking to avoid having the App freeze up.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ShinyVisuals.png" style="width:75.0%"></p>
<p>For standard workflow, scroll examining how the splitpoints were assigned for the individual samples. When you encounter a splitpoint line that was incorrectly set, hover just above the just above the x-axis for the correct location, and click on the spot with your mouse (see blue arrow for an example).</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ShinyUpdating.png" style="width:75.0%"></p>
<p>When you click just above the axis for the corrected splitpoint, you should see a click event captured message pop up in the console window of the Main R environment. If you click to far above the axis, you will not see this message displayed. Similarly, this message can be used to remember at what sample you left off when scrolling. All these clicks will save the coordinate as a splitpoint for that given marker and individual to a data.frame we will see on the next tab.</p>
<p>In terms of accidentally clicking the wrong location, only the last click for a respective sample will be used, so in case of a misclick, reclick on the correct location.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ConsoleClicks.png" style="width:75.0%"></p>
<p>Once you have corrected everything for a particular marker, switch down to the next x-axis marker, and regenerate the plots. Once they are loaded, proceed to correct the splitpoints for each additional marker.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/CorrectSplitpoints.png" style="width:75.0%"></p>
<p>Once this is complete, navigate to the Click Data tab on the upper left. You will see the click events in their totality. You will next need to export this data.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/ClickDataExport.png" style="width:75.0%"></p>
<p>Due to computer safety reasons, Shiny Apps are not allowed to write directly to your computer file system. So you will need to manually type in the file name and the file.path to a storage location. Once this is done, click “Export Click Data”. If this was done successfully, you should see the following notice appear.</p>
<p><img src="C:/Users/12692/AppData/Local/R/win-library/4.5/Coereba/extdata/CheckoutNotice.png" style="width:75.0%"></p>
<p>Finally, close out of the Shiny window, and hit the red stop button on the right-hand of the console to return back to Positron.</p>
<p>When working with a large dataset, we have observed the ShinyApp start to slow after a couple markers. When this occurs, save the click file to your destination folder, close the ShinyApp, and relaunch. Correct a couple additional markers, and save the Export Click Data again with a different name. After everything is gated, the same function used to update the Splitpoint.csv can be used to grab all .csv files from within a folder in a single go.</p>
<p>(Note for developers: Shiny relies heavily on reactive R, which is not the maintainer’s coding forte, so some additional work to speed things up behind the scenes is likely required. If this is your area of expertise, feel free to contribute!)</p>
</section></section><section class="section level2"><h2 id="updating-the-splitpoints">Updating the Splitpoints<a class="anchor" aria-label="anchor" href="#updating-the-splitpoints"></a>
</h2>
<p>Having gone through and corrected the splitpoints with <code><a href="../reference/Coereba_App.html">Coereba_App()</a></code>, it is time to convert your validated click-data and update the SecondGates.csv to reflect the changes. To facilitate this, we will use the <code><a href="../reference/Coereba_UpdateGates.html">Coereba_UpdateGates()</a></code> function. This can be used to update for either a single click-data .csv, or the file.path to the folder containing all the click-data .csv files in one go.</p>
<p>In our case, we will update using the saved click-data from above stored inside the extdata folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wherever you stored it</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For our example documentation</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span><span class="va">TheOldCSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">File_Location</span>, <span class="st">"SecondGates.csv"</span><span class="op">)</span></span>
<span><span class="va">TheClickInfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">File_Location</span>, <span class="st">"CorrectSplitpointLocations.csv"</span><span class="op">)</span></span>
<span><span class="va">TheClickData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">TheClickInfo</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">TheClickData</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Plot_Name          X_Label X_Coordinate                       Time
1     INF179     Comp-BV570-A          102  2025-11-30 14:35:32.16719
2   NY068_02     Comp-BV570-A          104 2025-11-30 14:35:34.988784
3     INF148     Comp-BV570-A          100 2025-11-30 14:35:38.030139
4     INF149     Comp-BV570-A          104 2025-11-30 14:35:43.327136
5     INF169     Comp-BV570-A          100 2025-11-30 14:35:45.103615
6   NY068_07     Comp-BV570-A          104 2025-11-30 14:35:53.786732
7   NY068_09     Comp-BV570-A          104 2025-11-30 14:36:01.280463
8     INF052     Comp-RB780-A          102 2025-11-30 14:37:52.210564
9     INF100     Comp-RB780-A          100 2025-11-30 14:37:55.166208
10  NY068_03     Comp-RB780-A          100 2025-11-30 14:38:03.626395
11    INF169     Comp-RB780-A          104  2025-11-30 14:38:08.80295
12  NY068_04     Comp-RB780-A          106 2025-11-30 14:38:11.201174
13    INF019     Comp-RB780-A          100 2025-11-30 14:38:13.839399
14    INF032     Comp-RB780-A          104 2025-11-30 14:38:15.777844
15  NY068_05     Comp-RB780-A          102 2025-11-30 14:38:20.034655
16    INF155     Comp-RB780-A           98 2025-11-30 14:38:21.464544
17    INF158     Comp-RB780-A          100 2025-11-30 14:38:23.338806
18    INF052    Comp-BUV661-A          100 2025-11-30 14:39:17.986655
19    INF100    Comp-BUV661-A          100 2025-11-30 14:39:19.746232
20    INF179    Comp-BUV661-A           98 2025-11-30 14:39:21.239516
21    INF191    Comp-BUV661-A          102 2025-11-30 14:39:27.352087
22    INF124    Comp-BUV661-A          100 2025-11-30 14:39:29.262508
23    INF169    Comp-BUV661-A          100 2025-11-30 14:39:31.839288
24    INF019    Comp-BUV661-A          100 2025-11-30 14:39:34.195555
25    INF180    Comp-BUV661-A          102 2025-11-30 14:39:36.821013
26    INF155    Comp-BUV661-A          100 2025-11-30 14:39:38.969446
27    INF159    Comp-BUV661-A          100 2025-11-30 14:39:41.252016
28    INF023    Comp-BUV661-A          100 2025-11-30 14:39:42.898831
29    INF030    Comp-BUV661-A          100 2025-11-30 14:39:45.107159
30    INF166    Comp-BUV661-A          104 2025-11-30 14:39:47.954736
31    INF199    Comp-BUV661-A           96 2025-11-30 14:39:50.678337
32    INF622    Comp-BUV661-A           98 2025-11-30 14:39:54.817167
33  NY068_02 Comp-PE-Vio770-A          128 2025-11-30 14:40:40.675504
34  NY068_03 Comp-PE-Vio770-A          132 2025-11-30 14:40:44.906669
35    INF149 Comp-PE-Vio770-A          120 2025-11-30 14:40:48.726542
36  NY068_04 Comp-PE-Vio770-A          128 2025-11-30 14:40:50.651213
37  NY068_05 Comp-PE-Vio770-A          132 2025-11-30 14:40:55.607554
38  NY068_06 Comp-PE-Vio770-A          124 2025-11-30 14:40:59.375889
39  NY068_07 Comp-PE-Vio770-A          130 2025-11-30 14:41:03.064329
40  NY068_08 Comp-PE-Vio770-A          128 2025-11-30 14:41:06.183731
41  NY068_09 Comp-PE-Vio770-A          132 2025-11-30 14:41:09.082866</code></pre>
</div>
</div>
<p>By comparison, the data from SecondGates that will be updated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheOldData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">TheOldCSV</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">TheOldData</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen Comp-BV570-A Comp-RB780-A Comp-BUV661-A Comp-PE-Vio770-A
1    INF052     106.4243     113.5925      113.6929         129.9561
2    INF100     103.3343     106.1959      114.6953         125.4605
3    INF179     109.8927     100.0000      110.0171         120.0000
4  NY068_02     114.4475     112.1331      100.0000         133.7100
5    INF134     100.0000     113.8992      101.3027         125.8119
6    INF148     109.9491     112.7546      110.7753         120.0000
7    INF191     112.2095     111.5551      104.6742         121.1411
8  NY068_03     104.7751     105.4302      100.0000         120.0000
9    INF124     103.7358     103.3443      102.5415         120.0000
10   INF149     102.3878     113.7956      102.5606         134.0682
11   INF169     111.7433     114.8728      109.4655         120.0000
12 NY068_04     101.8602     114.4828      100.0000         120.0000
13   INF019     100.0000     110.0912      111.0380         124.7991
14   INF032     100.1255     113.5904      100.3742         120.0000
15   INF180     109.8143     100.0000      113.1625         120.0000
16 NY068_05     113.1065     107.7955      100.0000         129.2545
17   INF155     110.6196     104.2215      108.2798         132.0553
18   INF158     103.4951     105.1166      100.1328         125.5335
19   INF159     102.4007     109.3739      106.1045         120.0000
20 NY068_06     102.9558     103.3860      100.0000         120.0000
21   INF023     100.0000     109.6757      108.1114         133.5714
22   INF030     100.0000     112.3273      108.5369         129.9226
23 NY068_07     100.0000     103.3227      100.0000         120.0000
24   INF166     100.8692     100.0000      108.1121         120.0000
25   INF199     108.9003     101.8914      111.4071         128.5388
26   INF207     100.0000     108.6026      100.8434         125.9516
27 NY068_08     111.6830     112.1937      100.0000         120.0000
28   INF614     108.5193     103.2181      100.6354         125.9203
29   INF622     104.7678     105.2147      103.3615         134.9934
30 NY068_09     100.0000     100.6811      100.0000         120.0000</code></pre>
</div>
</div>
<p>We can then run <code><a href="../reference/Coereba_UpdateGates.html">Coereba_UpdateGates()</a></code> and examine how the PE-Vio770 values are correspondingly updated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ShinyGatesSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_UpdateGates.html">Coereba_UpdateGates</a></span><span class="op">(</span>Clicks<span class="op">=</span><span class="va">TheClickInfo</span>, Old<span class="op">=</span><span class="va">TheOldCSV</span>,</span>
<span>  export<span class="op">=</span><span class="cn">FALSE</span>, outpath<span class="op">=</span><span class="cn">NULL</span>, fileName<span class="op">=</span><span class="st">"UpdatedCSV"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ShinyGatesSplitpoints</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen Comp-BV570-A Comp-RB780-A Comp-BUV661-A Comp-PE-Vio770-A
1    INF052     106.4243     102.0000      100.0000         129.9561
2    INF100     103.3343     100.0000      100.0000         125.4605
3    INF179     102.0000     100.0000       98.0000         120.0000
4  NY068_02     104.0000     112.1331      100.0000         128.0000
5    INF134     100.0000     113.8992      101.3027         125.8119
6    INF148     100.0000     112.7546      110.7753         120.0000
7    INF191     112.2095     111.5551      102.0000         121.1411
8  NY068_03     104.7751     100.0000      100.0000         132.0000
9    INF124     103.7358     103.3443      100.0000         120.0000
10   INF149     104.0000     113.7956      102.5606         120.0000
11   INF169     100.0000     104.0000      100.0000         120.0000
12 NY068_04     101.8602     106.0000      100.0000         128.0000
13   INF019     100.0000     100.0000      100.0000         124.7991
14   INF032     100.1255     104.0000      100.3742         120.0000
15   INF180     109.8143     100.0000      102.0000         120.0000
16 NY068_05     113.1065     102.0000      100.0000         132.0000
17   INF155     110.6196      98.0000      100.0000         132.0553
18   INF158     103.4951     100.0000      100.1328         125.5335
19   INF159     102.4007     109.3739      100.0000         120.0000
20 NY068_06     102.9558     103.3860      100.0000         124.0000
21   INF023     100.0000     109.6757      100.0000         133.5714
22   INF030     100.0000     112.3273      100.0000         129.9226
23 NY068_07     104.0000     103.3227      100.0000         130.0000
24   INF166     100.8692     100.0000      104.0000         120.0000
25   INF199     108.9003     101.8914       96.0000         128.5388
26   INF207     100.0000     108.6026      100.8434         125.9516
27 NY068_08     111.6830     112.1937      100.0000         128.0000
28   INF614     108.5193     103.2181      100.6354         125.9203
29   INF622     104.7678     105.2147       98.0000         134.9934
30 NY068_09     104.0000     100.6811      100.0000         132.0000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Designate a location file.path to save the Shiny Updated Splitpoints to</span></span>
<span><span class="va">StorageLocationForShinyUpdatedSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForShinyUpdatedSplitpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ShinyGatesPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">StorageLocationForShinyUpdatedSplitpoints</span>, <span class="st">"ShinyGates.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">ShinyGatesSplitpoints</span>, <span class="va">ShinyGatesPath</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<p>We in turn can validate this further by by re-running <code>Luciernaga</code> <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_NbyNPlots.html" class="external-link">Utility_NbyNPlots()</a></code> or <code>Utility_UnityPlots()</code> using the updated GateCutoff.csv and see how things look now following our intervention.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StorageLocationForPlotPDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UpdatedPlotAfterShiny</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_NbyNPlots.html" class="external-link">Utility_NbyNPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GROUPNAME"</span><span class="op">)</span>, experiment<span class="op">=</span><span class="st">"ABs"</span>,</span>
<span>condition<span class="op">=</span><span class="st">"DNs"</span>, removestrings<span class="op">=</span><span class="st">".fcs"</span>, marginsubset<span class="op">=</span><span class="st">"root"</span>, gatesubset<span class="op">=</span><span class="st">"root"</span>, </span>
<span>ycolumn<span class="op">=</span><span class="st">"Comp-PE-Vio770-A"</span>, bins<span class="op">=</span><span class="fl">150</span>, clearance<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>gatelines<span class="op">=</span><span class="cn">TRUE</span>, reference<span class="op">=</span><span class="va">ShinyGatesSplitpoints</span>, outpath<span class="op">=</span><span class="va">StorageLocationForPlotPDF</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UpdatedPlotAfterShiny</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="coereba-1">Coereba<a class="anchor" aria-label="anchor" href="#coereba-1"></a>
</h2>
<p>With the gate locations now finalized, it’s time to run Coereba and classify each individual cell within a specimen by it’s marker expression relative to their respective splitpoint location. Cells that share marker expressions ultimately end up in the same clusters. We will use the <code><a href="../reference/Utility_Coereba.html">Utility_Coereba()</a></code> function for this process, providing both the validated ShinyGates and our GatingSet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wherever you stored it</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For our example documentation</span></span>
<span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CheckedGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">File_Location</span>, <span class="st">"ShinyGates.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CoerebaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_Coereba.html">Utility_Coereba</a></span><span class="op">(</span>gs<span class="op">=</span><span class="va">UnmixedGatingSet</span>, subsets<span class="op">=</span><span class="st">"root"</span>,</span>
<span> sample.name<span class="op">=</span><span class="st">"GROUPNAME"</span>, reference<span class="op">=</span><span class="va">CheckedGates</span>, starter<span class="op">=</span><span class="st">"Comp-PE-Vio770-A"</span>,</span>
<span> inverse.transform <span class="op">=</span> <span class="cn">TRUE</span>, returnType<span class="op">=</span><span class="st">"data"</span>, Individual<span class="op">=</span><span class="cn">FALSE</span>, outpath<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> columns <span class="op">=</span> <span class="va">MarkersForToday</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CoerebaData</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Time    SSC-W  SSC-H    SSC-A    FSC-W   FSC-H   FSC-A  SSC-B-W
1 0.007250432 757468.7 319916 403877.2 723836.3 1314920 1586311 759363.8
2 0.049536157 764963.2 433967 553281.3 713654.9 1075821 1279608 736022.6
3 0.158876628 829243.2 337209 466047.1 731967.6 1151849 1405194 789358.2
4 0.086781256 851596.2 651951 925331.7 786383.0 1359889 1782323 824939.2
5 0.147267058 710492.4 502576 595127.4 733292.0 1190929 1455498 685358.0
6 0.003717238 734286.3 321066 392924.0 722650.5 1183293 1425179 725114.2
  SSC-B-H  SSC-B-A Comp-BUV395-A Comp-BUV563-A Comp-BUV615-A Comp-BUV661-A
1  221231 279991.4      438.7249      1040.404     -680.8043    -129.44624
2  300984 369218.3      829.8121      7123.970    -1994.0029    -232.51152
3  319848 420791.0     1280.9078      3803.623      713.0327     510.93674
4  625532 860043.2     -439.4222     30278.248    -1139.0708     315.45111
5  371090 423882.5      221.7194     19312.646     -140.6563      13.20995
6  239985 290027.6      908.4125      2258.362    -2010.0111     377.78735
  Comp-BUV737-A Comp-BUV805-A Comp-Pacific Blue-A Comp-BV480-A Comp-BV570-A
1    2549.84912     1215.4592            282.3041    -572.2485    153.71027
2    -485.93094     -154.2776            390.7733     244.7173   -216.41353
3      26.77089      831.5299           -551.6248   61308.6914    466.36249
4    7057.75732      536.5324           -239.2623    7667.9570   6461.04248
5    7611.88867      -75.4399           -201.6307    -519.2786   -322.98361
6     443.79602     -672.4197           -171.0772    1798.1503    -65.80224
  Comp-BV605-A Comp-BV650-A Comp-BV711-A Comp-BV750-A Comp-BV786-A
1    68198.375   1023.61847    -731.8307   1000.20520   -645.06366
2    77018.008    864.49603    1143.2937    216.37506    332.01163
3    47829.953    659.00372    -421.0473    376.08987   2430.74023
4    82163.375   -612.73761     738.0031    300.63382    228.46538
5     9739.221    -24.65056     517.4077   -571.34906   1850.53870
6    80161.500   1256.53894     395.2672    -19.04926    -39.42794
  Comp-Alexa Fluor 488-A Comp-Spark Blue 550-A Comp-Spark Blue 574-A
1               292.3369             20156.818             13158.829
2               117.0703             19328.055             14605.964
3               303.3434             39898.215              8893.732
4               335.7022              5267.546             17848.094
5              -165.4469             19023.338             15812.108
6               361.5220             32481.230             17229.527
  Comp-RB613-A Comp-RB705-A Comp-RB780-A  Comp-PE-A Comp-PE-Dazzle594-A
1    5301.5435   10037.8467     34.78101 -441.28574            452.7408
2    7963.9473    -189.9107    361.52679  187.94661            543.6385
3   13183.2686   14911.6729   -470.96722  398.12598           1331.9326
4    -907.1228     820.5016    -54.07310   30.90817           -302.6173
5    -798.1833   13849.3203    200.38297 1520.73181            755.9047
6   23507.9609     539.2426   -433.34854  488.68903           1538.9198
  Comp-PE-Cy5-A Comp-PE-Fire 700-A Comp-PE-Fire 744-A Comp-PE-Vio770-A
1   1367.510010          3930.5979          -191.9662         287.9828
2   9366.500977         18811.5547           430.7565        -266.3836
3   6857.629883          9814.5254           636.4847         139.9735
4   1010.400208          -598.0698           237.3655         374.5992
5     -8.154349          6291.7842           646.8314        -562.7638
6   1592.384766          2363.7073          -232.3961        1000.6408
  Comp-APC-A Comp-Alexa Fluor 647-A Comp-APC-R700-A Comp-Zombie NIR-A
1  -168.0962              435.59430       169.38956          519.8437
2   197.0268              682.41821      -223.81580         1065.2352
3  -241.4765              312.44339       -25.27080         1216.3936
4  -480.8164              921.70477       -38.77645         1657.5844
5   115.7601              719.88556       196.36331          -92.2728
6   442.7861              -26.69396       386.12088          467.5624
  Comp-APC-Fire 750-A Comp-APC-Fire 810-A Comp-AF-A
1          13850.8506           4013.1704  3947.339
2           5775.3535           1138.0210  3367.960
3           9555.0957           4049.2446  3144.890
4           -469.8659           1121.9797  3694.532
5          17794.6875           3649.3025  4262.999
6          11859.1738            738.9268  3819.853
                               Cluster specimen
1 PEVio770negBV570negRB780negBUV661neg   INF052
2 PEVio770negBV570negRB780negBUV661neg   INF052
3 PEVio770negBV570negRB780negBUV661neg   INF052
4 PEVio770negBV570negRB780negBUV661neg   INF052
5 PEVio770negBV570negRB780negBUV661neg   INF052
6 PEVio770negBV570negRB780negBUV661neg   INF052</code></pre>
</div>
</div>
<p>In the above case, we set returnType = “data”, and Individual = “FALSE”, resulting in a single data.frame containing the content for all specimens. Please refer to the documentation for <code><a href="../reference/Utility_Coereba.html">Utility_Coereba()</a></code> for additional options.</p>
</section><section class="section level2"><h2 id="save-to-fcs-file-optional">Save to FCS file (optional)<a class="anchor" aria-label="anchor" href="#save-to-fcs-file-optional"></a>
</h2>
<p>Once <code><a href="../reference/Utility_Coereba.html">Utility_Coereba()</a></code> has been run, we can send the output to an .fcs file. In this process, any metadata present will be converted over to numeric keyword format, with the actual information stored away as keywords for later retrieval. Exporting as an .fcs can can be useful when we are planning to export to an .fcs file for downstream unsupervised analysis, as it allows us to run dimensionality visualization algorithms, gate the islands, and then retrieve Coereba data as far as gating and metadata from cells within those respective islands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Designate a location file.path to save the Shiny Updated Splitpoints to</span></span>
<span><span class="va">StorageLocationForFCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will use a temp() folder for this documentation example. </span></span>
<span><span class="va">StorageLocationForFCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FCSFile</span> <span class="op">&lt;-</span> <span class="fu">Coereba</span><span class="fu">::</span><span class="fu"><a href="../reference/Coereba_FCSExport.html">Coereba_FCSExport</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CoerebaData</span>, gs<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      returnType<span class="op">=</span><span class="st">"fcs"</span>, outpath<span class="op">=</span><span class="va">StorageLocationForFCS</span>, filename<span class="op">=</span><span class="st">"CoerebaTest"</span>,</span>
<span>      nameAppend<span class="op">=</span><span class="st">""</span>, Aggregate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Likewise, once we are done with the unsupervised analysis, we can retrieve the same data back to R through the <code><a href="../reference/Coereba_FCS_Reversal.html">Coereba_FCS_Reversal()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FCSPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">StorageLocationForFCS</span>, <span class="st">"CoerebaTest.fcs"</span><span class="op">)</span></span>
<span><span class="va">RetrievedData</span> <span class="op">&lt;-</span> <span class="fu">Coereba</span><span class="fu">::</span><span class="fu"><a href="../reference/Coereba_FCS_Reversal.html">Coereba_FCS_Reversal</a></span><span class="op">(</span>Coereba<span class="op">=</span><span class="va">FCSPath</span><span class="op">)</span></span>
<span><span class="co"># View(RetrievedData)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">RetrievedData</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Time    SSC-W  SSC-H    SSC-A    FSC-W   FSC-H   FSC-A  SSC-B-W
1 0.007250432 757468.7 319916 403877.2 723836.3 1314920 1586311 759363.8
2 0.049536157 764963.2 433967 553281.3 713654.9 1075821 1279608 736022.6
3 0.158876628 829243.2 337209 466047.1 731967.6 1151849 1405194 789358.2
4 0.086781256 851596.2 651951 925331.7 786383.0 1359889 1782323 824939.2
5 0.147267058 710492.4 502576 595127.4 733292.0 1190929 1455498 685358.0
  SSC-B-H  SSC-B-A  BUV395-A  BUV563-A   BUV615-A   BUV661-A   BUV737-A
1  221231 279991.4  438.7249  1040.404  -680.8043 -129.44624 2549.84912
2  300984 369218.3  829.8121  7123.970 -1994.0029 -232.51152 -485.93094
3  319848 420791.0 1280.9078  3803.623   713.0327  510.93674   26.77089
4  625532 860043.2 -439.4222 30278.248 -1139.0708  315.45111 7057.75732
5  371090 423882.5  221.7194 19312.646  -140.6563   13.20995 7611.88867
   BUV805-A Pacific Blue-A    BV480-A   BV570-A   BV605-A    BV650-A   BV711-A
1 1215.4592       282.3041  -572.2485  153.7103 68198.375 1023.61847 -731.8307
2 -154.2776       390.7733   244.7173 -216.4135 77018.008  864.49603 1143.2937
3  831.5299      -551.6248 61308.6914  466.3625 47829.953  659.00372 -421.0473
4  536.5324      -239.2623  7667.9570 6461.0425 82163.375 -612.73761  738.0031
5  -75.4399      -201.6307  -519.2786 -322.9836  9739.221  -24.65056  517.4077
    BV750-A   BV786-A Alexa Fluor 488-A Spark Blue 550-A Spark Blue 574-A
1 1000.2052 -645.0637          292.3369        20156.818        13158.829
2  216.3751  332.0116          117.0703        19328.055        14605.964
3  376.0899 2430.7402          303.3434        39898.215         8893.732
4  300.6338  228.4654          335.7022         5267.546        17848.094
5 -571.3491 1850.5387         -165.4469        19023.338        15812.108
     RB613-A    RB705-A    RB780-A       PE-A PE-Dazzle594-A    PE-Cy5-A
1  5301.5435 10037.8467   34.78101 -441.28574       452.7408 1367.510010
2  7963.9473  -189.9107  361.52679  187.94661       543.6385 9366.500977
3 13183.2686 14911.6729 -470.96722  398.12598      1331.9326 6857.629883
4  -907.1228   820.5016  -54.07310   30.90817      -302.6173 1010.400208
5  -798.1833 13849.3203  200.38297 1520.73181       755.9047   -8.154349
  PE-Fire 700-A PE-Fire 744-A PE-Vio770-A     APC-A Alexa Fluor 647-A
1     3930.5979     -191.9662    287.9828 -168.0962          435.5943
2    18811.5547      430.7565   -266.3836  197.0268          682.4182
3     9814.5254      636.4847    139.9735 -241.4765          312.4434
4     -598.0698      237.3655    374.5992 -480.8164          921.7048
5     6291.7842      646.8314   -562.7638  115.7601          719.8856
  APC-R700-A Zombie NIR-A APC-Fire 750-A APC-Fire 810-A     AF-A
1  169.38956     519.8437     13850.8506       4013.170 3947.339
2 -223.81580    1065.2352      5775.3535       1138.021 3367.960
3  -25.27080    1216.3936      9555.0957       4049.245 3144.890
4  -38.77645    1657.5844      -469.8659       1121.980 3694.532
5  196.36331     -92.2728     17794.6875       3649.302 4262.999
                               Cluster specimen
1 PEVio770negBV570negRB780negBUV661neg   INF052
2 PEVio770negBV570negRB780negBUV661neg   INF052
3 PEVio770negBV570negRB780negBUV661neg   INF052
4 PEVio770negBV570negRB780negBUV661neg   INF052
5 PEVio770negBV570negRB780negBUV661neg   INF052</code></pre>
</div>
</div>
</section><section class="section level2"><h2 id="generating-a-summarized-experiment-file">Generating a Summarized Experiment File<a class="anchor" aria-label="anchor" href="#generating-a-summarized-experiment-file"></a>
</h2>
<p>Taking the <code><a href="../reference/Utility_Coereba.html">Utility_Coereba()</a></code> output, we can combine it with metadata and panel information into a SummarizedExperiment object. This will permit us in turn to tie in to a lot of the existing Bioconductor project analysis infrastructure. We do this through the <code><a href="../reference/Coereba_Processing.html">Coereba_Processing()</a></code> function.</p>
<p>We will need to provide a data.frame or a file.path to a csv file containing the panel information. The first column should be called Fluorophore, with the second column the marker name. For our example since we are working with only four markers, we will create and pass this from R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePanel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Fluorophore<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV661"</span>, <span class="st">"BV570"</span>, <span class="st">"RB780"</span>, <span class="st">"PE-Vio770"</span><span class="op">)</span>,</span>
<span>  Marker<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vd2"</span>, <span class="st">"CD16"</span>, <span class="st">"CXCR5"</span>, <span class="st">"HLA-DR"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Similar to what we did for <code><a href="../reference/Coereba_GateCutoffs.html">Coereba_GateCutoffs()</a></code>, we can have return a csv template containing the specimen names present.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MetadataOutpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MetadataTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_Processing.html">Coereba_Processing</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">FCSPath</span>, metadataTemplate<span class="op">=</span><span class="cn">TRUE</span>, outpath<span class="op">=</span><span class="va">MetadataOutpath</span>, panel<span class="op">=</span><span class="va">ThePanel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MetadataLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">MetadataOutpath</span>, <span class="st">"Coereba_metadataTemplate.csv"</span><span class="op">)</span></span>
<span><span class="va">InitialMetadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">MetadataLocation</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">InitialMetadata</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen
1   INF019
2   INF023
3   INF030
4   INF032
5   INF052</code></pre>
</div>
</div>
<p>Now that we have the specimen identifiers, we can append additional metadata utilizing the <code>left_join()</code> function from the <code>dplyr</code> package, before returning the updated metadata to <code><a href="../reference/Coereba_Processing.html">Coereba_Processing()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Coereba"</span><span class="op">)</span></span>
<span><span class="va">StudyMetadataPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">File_Location</span>, <span class="st">"SDY3080.csv"</span><span class="op">)</span></span>
<span><span class="va">StudyMetadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">StudyMetadataPath</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Specimens</span> <span class="op">&lt;-</span> <span class="va">InitialMetadata</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="va">specimen</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding Adult Normalization Controls Not Present in Study Metadata</span></span>
<span><span class="va">Specimens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Specimens</span>, <span class="st">"NY068_02"</span>, <span class="st">"NY068_03"</span>, <span class="st">"NY068_03"</span>, <span class="st">"NY068_4"</span>,</span>
<span> <span class="st">"NY068_5"</span>, <span class="st">"NY068_6"</span>, <span class="st">"NY068_7"</span>, <span class="st">"NY068_8"</span><span class="op">)</span></span>
<span><span class="va">StudyMetadata</span> <span class="op">&lt;-</span> <span class="va">StudyMetadata</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bid</span> <span class="op"><a href="https://rdrr.io/pkg/flowCore/man/filter-in-methods.html" class="external-link">%in%</a></span> <span class="va">Specimens</span><span class="op">)</span></span>
<span><span class="va">StudyMetadata</span> <span class="op">&lt;-</span> <span class="va">StudyMetadata</span> <span class="op">|&gt;</span> <span class="fu">rename</span><span class="op">(</span>specimen<span class="op">=</span><span class="va">bid</span><span class="op">)</span></span>
<span><span class="va">CoerebaMetadata</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">InitialMetadata</span>, <span class="va">StudyMetadata</span>, by<span class="op">=</span><span class="st">"specimen"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CoerebaMetadata</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen infant_sex  ptype
1   INF019     Female HEU-lo
2   INF023     Female HEU-hi
3   INF030       Male     HU
4   INF032     Female     HU
5   INF052       Male HEU-hi</code></pre>
</div>
</div>
<p>With the pieces now assembled, we can combine everything into a SummarizedExperiment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_Processing.html">Coereba_Processing</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">FCSPath</span>, panel<span class="op">=</span><span class="va">ThePanel</span>, themetadata<span class="op">=</span><span class="va">CoerebaMetadata</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class: SummarizedExperiment
dim: 12 30
metadata(1): panel
assays(2): ratios count
rownames(12): 1 2 ... 11 12
rowData names(5): Identity PEVio770 BV570 RB780 BUV661
colnames(30): INF019 INF023 ... NY068_08 NY068_09
colData names(3): specimen infant_sex ptype</code></pre>
</div>
</div>
<p>Using the various Bioconductor accessors, we can see the respective contents. We can see the counts for the individual clusters by specimen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span><span class="op">@</span><span class="va">assays</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">count</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 30
   INF019 INF023 INF030 INF032 INF052 INF100 INF124 INF134 INF148 INF149 INF155
    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
 1    480    437    542    634    778    779    641    530    566    665    806
 2     51     33     20     38     43     65     47     30     24     28     43
 3      1      0      1      0      0      0      0      0      0      0      0
 4    257    329    342    108     61     44    108    316    106    106     18
 5      8      3      2     14     49    103     22     34    120    128     73
 6    202    198     90    205     67      8    182     90    182     73     59
 7      1      0      1      0      0      1      0      0      2      0      1
 8      0      0      1      0      0      0      0      0      0      0      0
 9      0      0      1      0      0      0      0      0      0      0      0
10      0      0      0      1      0      0      0      0      0      0      0
11      0      0      0      0      1      0      0      0      0      0      0
12      0      0      0      0      1      0      0      0      0      0      0
# ℹ 19 more variables: INF158 &lt;int&gt;, INF159 &lt;int&gt;, INF166 &lt;int&gt;, INF169 &lt;int&gt;,
#   INF179 &lt;int&gt;, INF180 &lt;int&gt;, INF191 &lt;int&gt;, INF199 &lt;int&gt;, INF207 &lt;int&gt;,
#   INF614 &lt;int&gt;, INF622 &lt;int&gt;, NY068_02 &lt;int&gt;, NY068_03 &lt;int&gt;, NY068_04 &lt;int&gt;,
#   NY068_05 &lt;int&gt;, NY068_06 &lt;int&gt;, NY068_07 &lt;int&gt;, NY068_08 &lt;int&gt;,
#   NY068_09 &lt;int&gt;</code></pre>
</div>
</div>
<p>Similar case for the proportions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span><span class="op">@</span><span class="va">assays</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">ratios</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 30
   INF019 INF023 INF030 INF032 INF052 INF100 INF124 INF134 INF148 INF149 INF155
    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1  0.48   0.437  0.542  0.634  0.778  0.779  0.641  0.53   0.566  0.665  0.806
 2  0.051  0.033  0.02   0.038  0.043  0.065  0.047  0.03   0.024  0.028  0.043
 3  0.001  0      0.001  0      0      0      0      0      0      0      0
 4  0.257  0.329  0.342  0.108  0.061  0.044  0.108  0.316  0.106  0.106  0.018
 5  0.008  0.003  0.002  0.014  0.049  0.103  0.022  0.034  0.12   0.128  0.073
 6  0.202  0.198  0.09   0.205  0.067  0.008  0.182  0.09   0.182  0.073  0.059
 7  0.001  0      0.001  0      0      0.001  0      0      0.002  0      0.001
 8  0      0      0.001  0      0      0      0      0      0      0      0
 9  0      0      0.001  0      0      0      0      0      0      0      0
10  0      0      0      0.001  0      0      0      0      0      0      0
11  0      0      0      0      0.001  0      0      0      0      0      0
12  0      0      0      0      0.001  0      0      0      0      0      0
# ℹ 19 more variables: INF158 &lt;dbl&gt;, INF159 &lt;dbl&gt;, INF166 &lt;dbl&gt;, INF169 &lt;dbl&gt;,
#   INF179 &lt;dbl&gt;, INF180 &lt;dbl&gt;, INF191 &lt;dbl&gt;, INF199 &lt;dbl&gt;, INF207 &lt;dbl&gt;,
#   INF614 &lt;dbl&gt;, INF622 &lt;dbl&gt;, NY068_02 &lt;dbl&gt;, NY068_03 &lt;dbl&gt;, NY068_04 &lt;dbl&gt;,
#   NY068_05 &lt;dbl&gt;, NY068_06 &lt;dbl&gt;, NY068_07 &lt;dbl&gt;, NY068_08 &lt;dbl&gt;,
#   NY068_09 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The expression for each cluster</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span><span class="op">@</span><span class="va">elementMetadata</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with 12 rows and 5 columns
                                Identity  PEVio770     BV570     RB780
                                &lt;factor&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
1   PEVio770negBV570negRB780negBUV661neg         0         0         0
2   PEVio770negBV570negRB780negBUV661pos         0         0         0
3   PEVio770negBV570negRB780posBUV661neg         0         0         1
4   PEVio770negBV570posRB780negBUV661neg         0         1         0
5   PEVio770posBV570negRB780negBUV661neg         1         0         0
...                                  ...       ...       ...       ...
8   PEVio770posBV570negRB780negBUV661pos         1         0         0
9   PEVio770posBV570negRB780posBUV661pos         1         0         1
10  PEVio770negBV570negRB780posBUV661pos         0         0         1
11  PEVio770negBV570posRB780negBUV661pos         0         1         0
12  PEVio770posBV570posRB780posBUV661neg         1         1         1
       BUV661
    &lt;numeric&gt;
1           0
2           1
3           0
4           0
5           0
...       ...
8           1
9           1
10          1
11          1
12          0</code></pre>
</div>
</div>
<p>The panel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span><span class="op">@</span><span class="va">metadata</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$panel
  Fluorophore Marker
1      BUV661    Vd2
2       BV570   CD16
3       RB780  CXCR5
4    PEVio770 HLA-DR</code></pre>
</div>
</div>
<p>And the metadata</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheBioconductor</span><span class="op">@</span><span class="va">colData</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame with 30 rows and 3 columns
            specimen  infant_sex       ptype
         &lt;character&gt; &lt;character&gt; &lt;character&gt;
INF019        INF019      Female      HEU-lo
INF023        INF023      Female      HEU-hi
INF030        INF030        Male          HU
INF032        INF032      Female          HU
INF052        INF052        Male      HEU-hi
...              ...         ...         ...
NY068_05    NY068_05          NA          NA
NY068_06    NY068_06          NA          NA
NY068_07    NY068_07          NA          NA
NY068_08    NY068_08          NA          NA
NY068_09    NY068_09          NA          NA</code></pre>
</div>
</div>
</section><section class="section level2"><h2 id="retrieving-marker-expressions">Retrieving Marker Expressions<a class="anchor" aria-label="anchor" href="#retrieving-marker-expressions"></a>
</h2>
<p>Now that our data is within the SummarizedExperiment, we can carry out different statistical analyses on the individual clusters, or reaggregate them to return summary statistics for the respective markers. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_MarkerExpressions.html">Coereba_MarkerExpressions</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">TheBioconductor</span>, returnType<span class="op">=</span><span class="st">"All"</span>, theassay<span class="op">=</span><span class="st">"ratios"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen infant_sex  ptype HLA-DR  CD16 CXCR5   Vd2
1   INF019     Female HEU-lo  0.211 0.258 0.203 0.051
2   INF023     Female HEU-hi  0.201 0.329 0.198 0.033
3   INF030       Male     HU  0.095 0.343 0.092 0.022
4   INF032     Female     HU  0.219 0.108 0.206 0.039
5   INF052       Male HEU-hi  0.117 0.063 0.068 0.044</code></pre>
</div>
</div>
<p>We can alternatively by setting returnType = “Combinatorial” derrive proportions that fall within quadrant gates for two markers of interest.To do this, we provide the fluorophores corresponding to the markers to the CombinatorialArgs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MemoryQuadrants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Coereba_MarkerExpressions.html">Coereba_MarkerExpressions</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">TheBioconductor</span>, theassay<span class="op">=</span><span class="st">"ratios"</span>,</span>
<span> returnType<span class="op">=</span><span class="st">"Combinatorial"</span>, CombinatorialArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV661"</span>, <span class="st">"RB780"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MemoryQuadrants</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen infant_sex  ptype Vd2-CXCR5+ Vd2+CXCR5+ Vd2+CXCR5- Vd2-CXCR5-
1   INF019     Female HEU-lo      0.203      0.000      0.051      0.746
2   INF023     Female HEU-hi      0.198      0.000      0.033      0.769
3   INF030       Male     HU      0.091      0.001      0.021      0.887
4   INF032     Female     HU      0.205      0.001      0.038      0.756
5   INF052       Male HEU-hi      0.068      0.000      0.044      0.888</code></pre>
</div>
</div>
<p>From this, we can see that within cord DN T cells, CXCR5 and Vd2 expression do not overlap for the most part.</p>
</section><section class="section level2"><h2 id="visualizing-marker-expression-with-beeswarm-boxplots">Visualizing Marker Expression with Beeswarm-Boxplots<a class="anchor" aria-label="anchor" href="#visualizing-marker-expression-with-beeswarm-boxplots"></a>
</h2>
<p>Having retrieve the marker expression data from the SummarizedExperiment, we can visualize the individual expression of the various markers across all individuals in the form of a beeswarm boxplot, using the <code><a href="../reference/Utility_MarkerPlots.html">Utility_MarkerPlots()</a></code>. These combine both the <em><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a></em> geom_boxplot() and <em><a href="https://CRAN.R-project.org/package=ggbeeswarm" class="external-link">ggbeeswarm</a></em> geom_beeswarm plots, with individual dots corresponding to individual specimen.</p>
<p>To help customize these plots for your particular use case, we provide some arguments to allow for the filtering and reordering of the markers shown in these plots, as well as some basic customizations and the ability to save as a .png. If you want to customize these further, the benefit of open-source software is our code is available, and you are welcome to make as many ggplot2 theme changes as you have time to tinker.</p>
<p>First thing’s first, you will need to specify which metadata column in your data.frame you want to use as factor, and provide the values a desired shape and fill value for each factor level. In the context of our data, we are using factors based on HIV viral and ART exposure, so for our example dataset we would set the values as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shape_ptype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HU"</span> <span class="op">=</span> <span class="fl">22</span>, <span class="st">"HEU-lo"</span> <span class="op">=</span> <span class="fl">21</span>, <span class="st">"HEU-hi"</span> <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">fill_ptype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HU"</span> <span class="op">=</span> <span class="st">"white"</span>, <span class="st">"HEU-lo"</span> <span class="op">=</span> <span class="st">"darkgray"</span>, <span class="st">"HEU-hi"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>We can start by viewing all markers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CordOnly</span> <span class="op">&lt;-</span> <span class="va">Data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ptype</span> <span class="op"><a href="https://rdrr.io/pkg/flowCore/man/filter-in-methods.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HU"</span>, <span class="st">"HEU-lo"</span>, <span class="st">"HEU-hi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ThePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_MarkerPlots.html">Utility_MarkerPlots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CordOnly</span>, myfactor<span class="op">=</span><span class="st">"ptype"</span>, shape_palette <span class="op">=</span> <span class="va">shape_ptype</span>, fill_palette <span class="op">=</span> <span class="va">fill_ptype</span>, panel<span class="op">=</span><span class="va">ThePanel</span>, XAxisLevels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vd2"</span>, <span class="st">"CD16"</span>, <span class="st">"CXCR5"</span>, <span class="st">"HLA-DR"</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">3</span>, size <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlot</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In `position_beeswarm`, method `center` discretizes the data axis (a.k.a the
continuous or non-grouped axis).
This may result in changes to the position of the points along that axis,
proportional to the value of `cex`.
This warning is displayed once per session.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s abbreviate the number of columns by specifying the marker names to include (filterForThese), and rearrange them in desired X-axis order</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_MarkerPlots.html">Utility_MarkerPlots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CordOnly</span>, myfactor<span class="op">=</span><span class="st">"ptype"</span>, shape_palette <span class="op">=</span> <span class="va">shape_ptype</span>, fill_palette <span class="op">=</span> <span class="va">fill_ptype</span>, panel<span class="op">=</span><span class="va">ThePanel</span>, cex<span class="op">=</span><span class="fl">4</span>, size <span class="op">=</span><span class="fl">3</span>, filterForThese<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vd2"</span>, <span class="st">"HLA-DR"</span><span class="op">)</span>, XAxisLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vd2"</span>, <span class="st">"HLA-DR"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell" width="50%">
<div class="sourceCode cell-code" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlot</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="statistics">Statistics<a class="anchor" aria-label="anchor" href="#statistics"></a>
</h2>
<p>The <code><a href="../reference/Utility_Stats.html">Utility_Stats()</a></code> and the <code><a href="../reference/Utility_Behemoth.html">Utility_Behemoth()</a></code> functions are a a coding-attempt to replicate the typical immunologist workflow, removing the need to copy-paste data from a .csv file to GraphPad Prism or similar software. Behind the scenes, it runs a normaly test, determines number of groups, and follows up with the corresponding t-test/anova/ based on whether parametric or non-parametric. <code><a href="../reference/Utility_Stats.html">Utility_Stats()</a></code> returns just a data.frame with the statistics, while <code><a href="../reference/Utility_Behemoth.html">Utility_Behemoth()</a></code> will return a beeswarm box-plot and display any statistical significant comparisons. Used in combination with <em><a href="https://CRAN.R-project.org/package=purrr" class="external-link">purrr</a></em> and <code>Luciernaga</code> <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_Patchwork.html" class="external-link">Utility_Patchwork()</a></code>, we can quickly pipe our data through to a .pdf file that we can quickly scroll through.</p>
<p>Does this approach save a lot of time? Yes. Are there caveats? Absolutely. With the ability to rapidly screen thousands of differential comparisons, we are essentially mining our haystacks for needles. Not every hit will actually be a needle, and the caveats that are associated with each test become meaningful to understand. Please use these functions responsibly, and check out the Statistical Rethinking series by Richard McElreath on YouTube.</p>
</section><section class="section level2"><h2 id="utility-statistics">Utility Statistics<a class="anchor" aria-label="anchor" href="#utility-statistics"></a>
</h2>
<p>Having retrieved a now tidyed data.frame using <code>Coereba_MarkerExpressions</code>, let’s switch from visualization to runnning statistical test with <code><a href="../reference/Utility_Stats.html">Utility_Stats()</a></code> for each of the markers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_Stats.html">Utility_Stats</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CordOnly</span>, var<span class="op">=</span><span class="st">"HLA-DR"</span>,</span>
<span>  myfactor<span class="op">=</span><span class="st">"infant_sex"</span>, normality<span class="op">=</span><span class="st">"dagostino"</span>, correction<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Result</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  marker            pvalue     normality
1 HLA-DR 0.264021672591926 nonparametric</code></pre>
</div>
</div>
<p>Rather than specifying each marker, we can leverage functional programming functions within the <em><a href="https://CRAN.R-project.org/package=purrr" class="external-link">purrr</a></em> to quickly check all markers using common statistical tests. We will need to skip over the metadata columns that are present at the begining of the dataframe, so let’s identify where these end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheLength</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">CordOnly</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">CordOnly</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "specimen"   "infant_sex" "ptype"      "HLA-DR"     "CD16"
[6] "CXCR5"      "Vd2"       </code></pre>
</div>
</div>
<p>With that done, we can now run provide the index to our factor of interest and all other non-metadata columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheData</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">CordOnly</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="va">TheLength</span><span class="op">)</span><span class="op">]</span>, <span class="op">~</span> <span class="fu"><a href="../reference/Utility_Stats.html">Utility_Stats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CordOnly</span>, var <span class="op">=</span> <span class="va">.x</span>, myfactor <span class="op">=</span> <span class="st">"infant_sex"</span>, </span>
<span>  normality <span class="op">=</span> <span class="st">"dagostino"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties
Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
</div>
<p>The results can be filtered using regular <em><a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a></em> functions. Nothing was statistically significant for this particular example, so I will set the pvalue at 0.3 to demonstrate the filtering</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MaybeSignificant</span> <span class="op">&lt;-</span> <span class="va">TheData</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pvalue</span> <span class="op">&lt;</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MaybeSignificant</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  marker            pvalue     normality
1 HLA-DR 0.264021672591926 nonparametric</code></pre>
</div>
</div>
</section><section class="section level2"><h2 id="utility_behemoth">Utility_Behemoth<a class="anchor" aria-label="anchor" href="#utility_behemoth"></a>
</h2>
<p>An extension to <code><a href="../reference/Utility_Stats.html">Utility_Stats()</a></code>, the <code><a href="../reference/Utility_Behemoth.html">Utility_Behemoth()</a></code> function will append the resulting p-value information onto a ggplot2 plot to allow us to visualize the underlying data. It’s plots are a combination of <em><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a></em> <code>geom_boxplot()</code> and <em><a href="https://CRAN.R-project.org/package=ggbeeswarm" class="external-link">ggbeeswarm</a></em> <code>geom_beeswarm()</code> plots. We have also provisioned the function to accept arguments to customize these and rearrange the group order. As with most <code>Coereba</code> plots, we will need to provide the shape and fill for our respective factors levels. If you miss a listing a level, these will not appear in the plot (but still impact the axis scaling, resulting in a warning)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shape_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span> <span class="op">=</span> <span class="fl">22</span>, <span class="st">"Male"</span> <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">fill_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span> <span class="op">=</span> <span class="st">"white"</span>, <span class="st">"Male"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>To do so for your own individual spots, you will need to specify a metadata column by which to factor by, and provide a list of shape and fill values corresponding to each factor level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SinglePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_Behemoth.html">Utility_Behemoth</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CordOnly</span>, var<span class="op">=</span><span class="st">"HLA-DR"</span>,</span>
<span>  myfactor<span class="op">=</span><span class="st">"infant_sex"</span>, normality<span class="op">=</span><span class="st">"dagostino"</span>, correction<span class="op">=</span><span class="st">"none"</span>,</span>
<span>  shape_palette<span class="op">=</span><span class="va">shape_sex</span>, fill_palette<span class="op">=</span><span class="va">fill_sex</span>,</span>
<span>  XAxisLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SinglePlot</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As was the case with <code><a href="../reference/Utility_Stats.html">Utility_Stats()</a></code>, when combined with the <em><a href="https://CRAN.R-project.org/package=purrr" class="external-link">purrr</a></em> package we can rapidly iterate over all the markers (skipping the initial metadata colums) and generate all the plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># colnames(AllMarkers)</span></span>
<span><span class="va">TheLength</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">CordOnly</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AllPlots</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">CordOnly</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="va">TheLength</span><span class="op">)</span><span class="op">]</span>, <span class="op">~</span> <span class="fu"><a href="../reference/Utility_Behemoth.html">Utility_Behemoth</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">CordOnly</span>, var<span class="op">=</span><span class="va">.x</span>,</span>
<span>  myfactor<span class="op">=</span><span class="st">"infant_sex"</span>, normality<span class="op">=</span><span class="st">"dagostino"</span>, correction<span class="op">=</span><span class="st">"none"</span>,</span>
<span>  shape_palette<span class="op">=</span><span class="va">shape_sex</span>, fill_palette<span class="op">=</span><span class="va">fill_sex</span>, corral.width<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>  XAxisLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell" width="50%">
<div class="sourceCode cell-code" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AllPlots</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-33-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-33-2.png" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-33-3.png" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-33-4.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These plots in turn can then be passed to <code>Luciernaga</code> <code><a href="https://davidrach.github.io/Luciernaga/reference/Utility_Patchwork.html" class="external-link">Utility_Patchwork()</a></code> to our desired layout, and subsequently exported out as a .pdf file for analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheAssembledPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_Patchwork.html" class="external-link">Utility_Patchwork</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">AllPlots</span>, filename<span class="op">=</span><span class="st">"CordBloodDNTcells"</span>,</span>
<span> outfolder<span class="op">=</span><span class="va">StorageLocation</span>, thecolumns<span class="op">=</span><span class="fl">2</span>, therows<span class="op">=</span><span class="fl">2</span>, width<span class="op">=</span><span class="fl">7</span>, height<span class="op">=</span><span class="fl">9</span>,</span>
<span> returntype<span class="op">=</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheAssembledPlot</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StorePDFHere</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">StorePDFHere</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheAssembledPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidrach.github.io/Luciernaga/reference/Utility_Patchwork.html" class="external-link">Utility_Patchwork</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">AllPlots</span>, filename<span class="op">=</span><span class="st">"CordBloodDNTcells"</span>,</span>
<span> outfolder<span class="op">=</span><span class="va">StorePDFHere</span>, thecolumns<span class="op">=</span><span class="fl">2</span>, therows<span class="op">=</span><span class="fl">2</span>, width<span class="op">=</span><span class="fl">7</span>, height<span class="op">=</span><span class="fl">9</span>,</span>
<span> returntype<span class="op">=</span><span class="st">"pdf"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26100)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=English_United States.utf8
[2] LC_CTYPE=English_United States.utf8
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.utf8

time zone: Etc/GMT+5
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
 [1] Luciernaga_0.99.6    gt_1.0.0             stringr_1.5.1
 [4] purrr_1.0.2          dplyr_1.1.4          data.table_1.15.4
 [7] ggcyto_1.36.0        ncdfFlow_2.54.0      BH_1.87.0-1
[10] ggplot2_3.5.2        openCyto_2.20.0      CytoML_2.20.0
[13] flowWorkspace_4.20.0 flowCore_2.20.0      BiocStyle_2.36.0
[16] Coereba_0.99.3

loaded via a namespace (and not attached):
  [1] RBGL_1.84.0                 gridExtra_2.3
  [3] rlang_1.1.6                 magrittr_2.0.3
  [5] shinydashboard_0.7.3        matrixStats_1.5.0
  [7] ggridges_0.5.6              compiler_4.5.1
  [9] vctrs_0.6.5                 reshape2_1.4.4
 [11] pkgconfig_2.0.3             crayon_1.5.3
 [13] fastmap_1.2.0               backports_1.5.0
 [15] XVector_0.48.0              labeling_0.4.3
 [17] promises_1.3.3              rmarkdown_2.29
 [19] ggbeeswarm_0.7.2            graph_1.86.0
 [21] ghibli_0.3.4                UCSC.utils_1.4.0
 [23] xfun_0.52                   GenomeInfoDb_1.44.0
 [25] jsonlite_1.8.8              later_1.4.2
 [27] SnowballC_0.7.1             DelayedArray_0.34.1
 [29] broom_1.0.8                 parallel_4.5.1
 [31] R6_2.6.1                    stringi_1.8.3
 [33] RColorBrewer_1.1-3          GenomicRanges_1.60.0
 [35] lubridate_1.9.3             figpatch_0.3.0
 [37] Rcpp_1.0.12                 SummarizedExperiment_1.38.1
 [39] knitr_1.50                  zoo_1.8-14
 [41] IRanges_2.42.0              httpuv_1.6.16
 [43] Matrix_1.7-3                timechange_0.3.0
 [45] tidyselect_1.2.1            abind_1.4-8
 [47] yaml_2.3.10                 viridis_0.6.5
 [49] timeDate_4041.110           qpdf_1.4.1
 [51] lattice_0.22-7              tibble_3.2.1
 [53] plyr_1.8.9                  withr_3.0.2
 [55] shiny_1.11.1                Biobase_2.68.0
 [57] askpass_1.2.1               evaluate_1.0.4
 [59] Rtsne_0.17                  xml2_1.3.6
 [61] pillar_1.11.0               lsa_0.73.3
 [63] BiocManager_1.30.22         MatrixGenerics_1.20.0
 [65] DT_0.33                     stats4_4.5.1
 [67] shinyjs_2.1.0               plotly_4.11.0
 [69] generics_0.1.4              S4Vectors_0.46.0
 [71] scales_1.4.0                timeSeries_4041.111
 [73] xtable_1.8-4                glue_1.8.0
 [75] lazyeval_0.2.2              tools_4.5.1
 [77] hexbin_1.28.3               spatial_7.3-18
 [79] fBasics_4041.97             pdftools_3.5.0
 [81] fs_1.6.6                    XML_3.99-0.16.1
 [83] grid_4.5.1                  flowClust_3.46.0
 [85] tidyr_1.3.1                 RProtoBufLib_2.20.0
 [87] colorspace_2.1-0            GenomeInfoDbData_1.2.14
 [89] patchwork_1.3.1             beeswarm_0.4.0
 [91] vipor_0.4.7                 cli_3.6.5
 [93] cytolib_2.20.0              S4Arrays_1.8.1
 [95] viridisLite_0.4.2           uwot_0.2.3
 [97] Rgraphviz_2.52.0            gtable_0.3.6
 [99] digest_0.6.35               prismatic_1.1.2
[101] progressr_0.15.1            BiocGenerics_0.54.0
[103] SparseArray_1.8.0           htmlwidgets_1.6.4
[105] farver_2.1.1                htmltools_0.5.8.1
[107] lifecycle_1.0.4             httr_1.4.7
[109] mime_0.13                   MASS_7.3-65                </code></pre>
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Rach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
